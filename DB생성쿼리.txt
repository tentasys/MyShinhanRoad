-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.

-- Course Table Create SQL
CREATE TABLE Course
(
    `course_num`    INT            NOT NULL    AUTO_INCREMENT COMMENT '강좌 번호', 
    `course_title`  VARCHAR(45)    NULL        COMMENT '제목', 
    `course_tch`    VARCHAR(45)    NULL        COMMENT '강사', 
    `course_level`  VARCHAR(45)    NULL        COMMENT '레벨', 
    `course_text`   TEXT           NULL        COMMENT '강의 설명', 
    PRIMARY KEY (course_num)
);

ALTER TABLE Course COMMENT '강좌';


-- Course Table Create SQL
CREATE TABLE Member
(
    `회원 번호`   INT             NOT NULL    AUTO_INCREMENT COMMENT 'mem_num', 
    `회원 토큰`   VARCHAR(255)    NOT NULL    COMMENT 'mem_token', 
    `랭킹 포인트`  INT             NULL        COMMENT 'mem_point', 
    PRIMARY KEY (회원 번호)
);

ALTER TABLE Member COMMENT '회원';


-- Course Table Create SQL
CREATE TABLE Lecture
(
    `lec_num`     INT             NOT NULL    AUTO_INCREMENT COMMENT '강의 번호', 
    `lec_title`   VARCHAR(25)     NULL        COMMENT '제목', 
    `lec_text`    TEXT            NULL        COMMENT '설명', 
    `lec_course`  INT             NOT NULL    COMMENT '강좌 번호', 
    `lec_path`    VARCHAR(100)    NULL        COMMENT '동영상 경로', 
    `lec_date`    DATE            NULL        COMMENT '업로드 날짜', 
    `lec_time`    INT             NULL        COMMENT '강의 시간(분)', 
    PRIMARY KEY (lec_num)
);

ALTER TABLE Lecture COMMENT '강의';

ALTER TABLE Lecture
    ADD CONSTRAINT FK_Lecture_lec_course_Course_course_num FOREIGN KEY (lec_course)
        REFERENCES Course (course_num) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- Course Table Create SQL
CREATE TABLE Tag
(
    `tag_num`   INT            NOT NULL    AUTO_INCREMENT COMMENT '태그 번호', 
    `tag_name`  VARCHAR(45)    NULL        COMMENT '태그명', 
    PRIMARY KEY (tag_num)
);

ALTER TABLE Tag COMMENT '태그';


-- Course Table Create SQL
CREATE TABLE Cop
(
    `CoP 번호`  INT            NOT NULL    AUTO_INCREMENT COMMENT 'cop_num', 
    `이름`      VARCHAR(45)    NULL        COMMENT 'cop_name', 
    `랭킹 포인트`  INT            NULL        COMMENT 'cop_point', 
    PRIMARY KEY (CoP 번호)
);

ALTER TABLE Cop COMMENT 'CoP';


-- Course Table Create SQL
CREATE TABLE Roadmap
(
    `road_num`   INT            NOT NULL    AUTO_INCREMENT COMMENT '로드맵 번호', 
    `road_name`  VARCHAR(25)    NULL        COMMENT '로드맵 이름', 
    `road_text`  TEXT           NULL        COMMENT '로드맵 설명', 
    PRIMARY KEY (road_num)
);

ALTER TABLE Roadmap COMMENT '로드맵';


-- Course Table Create SQL
CREATE TABLE Course_Tag
(
    `course_num`  INT    NOT NULL    COMMENT '강좌 번호', 
    `tag_num`     INT    NOT NULL    COMMENT '태그 번호'
);

ALTER TABLE Course_Tag COMMENT '강좌별 태그';

ALTER TABLE Course_Tag
    ADD CONSTRAINT FK_Course_Tag_course_num_Course_course_num FOREIGN KEY (course_num)
        REFERENCES Course (course_num) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE Course_Tag
    ADD CONSTRAINT FK_Course_Tag_tag_num_Tag_tag_num FOREIGN KEY (tag_num)
        REFERENCES Tag (tag_num) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- Course Table Create SQL
CREATE TABLE Mem_Cop
(
    `mem_num`  INT    NOT NULL    COMMENT '회원 번호', 
    `cop_num`  INT    NOT NULL    COMMENT 'CoP 번호'
);

ALTER TABLE Mem_Cop COMMENT '회원별 가입 CoP';

ALTER TABLE Mem_Cop
    ADD CONSTRAINT FK_Mem_Cop_mem_num_Member_회원 번호 FOREIGN KEY (mem_num)
        REFERENCES Member (회원 번호) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE Mem_Cop
    ADD CONSTRAINT FK_Mem_Cop_cop_num_Cop_CoP 번호 FOREIGN KEY (cop_num)
        REFERENCES Cop (CoP 번호) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- Course Table Create SQL
CREATE TABLE 회원 수강 테이블
(
    `mem_num`  INT    NOT NULL    COMMENT '회원 번호', 
    `lec_num`  INT    NOT NULL    COMMENT '수강 동영상', 
    PRIMARY KEY (mem_num)
);

ALTER TABLE 회원 수강 테이블 COMMENT 'Mem_Lecture';

ALTER TABLE 회원 수강 테이블
    ADD CONSTRAINT FK_회원 수강 테이블_lec_num_Lecture_lec_num FOREIGN KEY (lec_num)
        REFERENCES Lecture (lec_num) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE 회원 수강 테이블
    ADD CONSTRAINT FK_회원 수강 테이블_mem_num_Member_회원 번호 FOREIGN KEY (mem_num)
        REFERENCES Member (회원 번호) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- Course Table Create SQL
CREATE TABLE Roadmap_Course
(
    `road_num`    INT    NOT NULL    COMMENT '로드맵 번호', 
    `course_num`  INT    NOT NULL    COMMENT '강좌 번호', 
    PRIMARY KEY (road_num)
);

ALTER TABLE Roadmap_Course COMMENT '로드맵 별 강좌';

ALTER TABLE Roadmap_Course
    ADD CONSTRAINT FK_Roadmap_Course_road_num_Roadmap_road_num FOREIGN KEY (road_num)
        REFERENCES Roadmap (road_num) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE Roadmap_Course
    ADD CONSTRAINT FK_Roadmap_Course_course_num_Course_course_num FOREIGN KEY (course_num)
        REFERENCES Course (course_num) ON DELETE RESTRICT ON UPDATE RESTRICT;


